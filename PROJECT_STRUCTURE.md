# Road Sentinel Project Structure

Complete file structure for the Busay blind curve vehicle detection system.

## ğŸ“ Root Directory Structure

```
Road_Sentinel/
â”œâ”€â”€ datasets/                    # ğŸ—‚ï¸  All training datasets
â”‚   â”œâ”€â”€ downloaded/              # Raw datasets from Roboflow
â”‚   â””â”€â”€ processed/               # Merged/processed datasets
â”‚
â”œâ”€â”€ models/                      # ğŸ¯ Trained model versions
â”‚   â”œâ”€â”€ v1/                      # Version 1 models
â”‚   â”œâ”€â”€ v2/                      # Version 2 models (future)
â”‚   â””â”€â”€ production/              # Production-ready models (symlinks)
â”‚
â”œâ”€â”€ scripts/                     # ğŸ”§ Utility scripts
â”‚   â”œâ”€â”€ training/                # Model training scripts
â”‚   â”œâ”€â”€ download/                # Speed detection & calibration
â”‚   â””â”€â”€ extract_frames/          # Video frame extraction
â”‚
â”œâ”€â”€ docs/                        # ğŸ“š Documentation (future)
â””â”€â”€ README.md                    # Main project documentation
```

---

## ğŸ“¦ Detailed Structure

### `/datasets` - Training Data

```
datasets/
â”œâ”€â”€ README.md                    # Dataset management guide
â”‚
â”œâ”€â”€ downloaded/                  # Place Roboflow datasets here
â”‚   â”œâ”€â”€ .gitkeep
â”‚   â”œâ”€â”€ Traffic-surveillance-system-1/      # Your downloaded datasets
â”‚   â”œâ”€â”€ Vehicle-Detection-Day-Night-1/
â”‚   â””â”€â”€ Accident-detection-1/
â”‚
â””â”€â”€ processed/                   # Generated by merge scripts
    â”œâ”€â”€ .gitkeep
    â”œâ”€â”€ busay_vehicle_detection/           # Model 1 dataset
    â”‚   â”œâ”€â”€ data.yaml
    â”‚   â”œâ”€â”€ train/
    â”‚   â”‚   â”œâ”€â”€ images/
    â”‚   â”‚   â””â”€â”€ labels/
    â”‚   â”œâ”€â”€ valid/
    â”‚   â””â”€â”€ test/
    â”‚
    â””â”€â”€ busay_accident_detection/          # Model 2 dataset
        â”œâ”€â”€ data.yaml
        â”œâ”€â”€ train/
        â”œâ”€â”€ valid/
        â””â”€â”€ test/
```

**Storage:** ~15-20 GB total

**Usage:**
1. Download datasets from Roboflow â†’ place in `downloaded/`
2. Run `python scripts/training/run_merge_busay.py`
3. Merged datasets appear in `processed/`

---

### `/models` - Trained Models

```
models/
â”œâ”€â”€ README.md                    # Model versioning guide
â”‚
â”œâ”€â”€ v1/                          # Initial training (Roboflow data)
â”‚   â”œâ”€â”€ vehicle_detection/
â”‚   â”‚   â”œâ”€â”€ weights/
â”‚   â”‚   â”‚   â”œâ”€â”€ best.pt          # â­ Best performing model
â”‚   â”‚   â”‚   â””â”€â”€ last.pt          # Latest checkpoint
â”‚   â”‚   â”œâ”€â”€ results.png          # Training curves
â”‚   â”‚   â”œâ”€â”€ confusion_matrix.png
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â””â”€â”€ crash_detection/
â”‚       â””â”€â”€ weights/
â”‚           â”œâ”€â”€ best.pt
â”‚           â””â”€â”€ last.pt
â”‚
â”œâ”€â”€ v2/                          # Fine-tuned (+ Busay footage)
â”‚   â”œâ”€â”€ vehicle_detection_finetuned/
â”‚   â””â”€â”€ crash_detection_improved/
â”‚
â””â”€â”€ production/                  # Symlinks to current production models
    â”œâ”€â”€ vehicle_detector.pt -> ../v1/vehicle_detection/weights/best.pt
    â””â”€â”€ crash_detector.pt -> ../v1/crash_detection/weights/best.pt
```

**Storage:** ~200-400 MB per version

**Usage:**
- Train: `--project ../../models/v1 --name vehicle_detection`
- Deploy: Use `models/production/*.pt` in your application

---

### `/scripts/training` - Model Training

```
scripts/training/
â”œâ”€â”€ README.md                    # Training guide
â”‚
â”œâ”€â”€ requirements.txt             # Python dependencies
â”œâ”€â”€ venv_training/               # Virtual environment (created by you)
â”‚
â”œâ”€â”€ train_vehicle_detector.py   # ğŸš€ Main training script
â”œâ”€â”€ quick_train.py               # Quick start training
â”‚
â”œâ”€â”€ merge_busay_datasets.py      # Custom merger for your datasets
â”œâ”€â”€ run_merge_busay.py           # ğŸ¯ Automatic merge tool
â”œâ”€â”€ analyze_datasets.py          # Dataset analysis tool
â”‚
â”œâ”€â”€ convert_aicity_track1_to_yolo.py  # AI City Challenge converters
â”œâ”€â”€ convert_aicity_track4_to_yolo.py
â”œâ”€â”€ download_roboflow_datasets.py     # Roboflow download guide
â”‚
â”œâ”€â”€ DATASET_STRATEGY_GUIDE.md   # Should I merge datasets?
â”œâ”€â”€ DUAL_MODEL_TRAINING_GUIDE.md # Training both models
â”œâ”€â”€ OVERHEAD_CAMERA_GUIDE.md    # Angled camera setup
â””â”€â”€ YOLO_NATIVE_DATASETS.md     # Roboflow Universe guide
```

**Key Files:**
- **`run_merge_busay.py`** - Run this first to merge your datasets
- **`train_vehicle_detector.py`** - Run this to train models
- **`DATASET_STRATEGY_GUIDE.md`** - Read this to understand merge vs single dataset

---

### `/scripts/download` - Speed Detection & Calibration

```
scripts/download/
â”œâ”€â”€ README.md                    # Speed detection guide
â”‚
â”œâ”€â”€ auto_download_coco.py        # ğŸš— Vehicle speed detector
â”‚                                # (Multi-vehicle tracking, speed calculation)
â”‚
â””â”€â”€ angled_camera_calibration.py # ğŸ“ Camera perspective calibration
                                 # (For overhead/angled cameras)
```

**Purpose:**
- `auto_download_coco.py` - Run this to detect vehicles and measure speed in videos
- `angled_camera_calibration.py` - Calibrate camera for accurate speed from angled view

---

### `/scripts/extract_frames` - Video Processing

```
scripts/extract_frames/
â”œâ”€â”€ README.md
â”œâ”€â”€ extract_frames.py            # Extract frames from videos
â””â”€â”€ requirements.txt
```

**Purpose:** Convert videos to images for dataset creation

---

## ğŸš€ Typical Workflow

### Phase 1: Setup & Data Preparation

```bash
# 1. Download datasets from Roboflow
# Place in: datasets/downloaded/

# 2. Merge datasets
cd scripts/training
python run_merge_busay.py
# Output: datasets/processed/busay_vehicle_detection/
#         datasets/processed/busay_accident_detection/
```

### Phase 2: Training

```bash
# 3. Train Model 1 (Vehicle Detection)
python train_vehicle_detector.py \
  --data ../../datasets/processed/busay_vehicle_detection/data.yaml \
  --model n \
  --batch 4 \
  --epochs 100 \
  --project ../../models/v1 \
  --name vehicle_detection
# Output: models/v1/vehicle_detection/weights/best.pt

# 4. Train Model 2 (Crash Detection)
python train_vehicle_detector.py \
  --data ../../datasets/processed/busay_accident_detection/data.yaml \
  --model n \
  --batch 4 \
  --epochs 100 \
  --project ../../models/v1 \
  --name crash_detection
# Output: models/v1/crash_detection/weights/best.pt
```

### Phase 3: Deployment

```bash
# 5. Create production symlinks
cd ../../models/production
ln -sf ../v1/vehicle_detection/weights/best.pt vehicle_detector.pt
ln -sf ../v1/crash_detection/weights/best.pt crash_detector.pt

# 6. Calibrate cameras
cd ../../scripts/download
python angled_camera_calibration.py

# 7. Run speed detection
python auto_download_coco.py
# (Edit to use: '../../models/production/vehicle_detector.pt')
```

---

## ğŸ“Š Storage Requirements

| Directory | Size | Description |
|-----------|------|-------------|
| `datasets/downloaded/` | 5-10 GB | Raw Roboflow datasets |
| `datasets/processed/` | 5-10 GB | Merged datasets |
| `models/v1/` | 200 MB | First training run |
| `models/v2/` | 200 MB | Fine-tuned models |
| `scripts/` | 50 MB | Code and docs |
| **Total** | **10-20 GB** | Full project |

---

## ğŸ§¹ Cleaning Up

### Free up space after training:

```bash
# Remove downloaded datasets (keep processed only)
rm -rf datasets/downloaded/*

# Remove training checkpoints (keep best.pt only)
find models/ -name "last.pt" -delete
find models/ -name "*.png" -delete  # Remove graphs
```

### Keep only essentials (production):

```
Road_Sentinel/
â”œâ”€â”€ datasets/processed/          # Processed datasets
â”œâ”€â”€ models/production/           # Production models
â”œâ”€â”€ scripts/download/            # Speed detection
â””â”€â”€ scripts/training/            # For future retraining
```

---

## ğŸ“ Version Control (.gitignore)

Add to `.gitignore`:

```gitignore
# Datasets (too large for git)
datasets/downloaded/*
datasets/processed/*
!datasets/**/.gitkeep

# Models (use Git LFS or external storage)
models/*/
!models/**/.gitkeep

# Virtual environments
venv_*/
__pycache__/
*.pyc

# Training outputs
runs/
*.log
```

---

## ğŸ“ For Your Thesis

Document this structure in your thesis:

### Project Organization Section:
- Explain the separation of datasets, models, and scripts
- Show version management (v1, v2, etc.)
- Describe the workflow from data â†’ training â†’ deployment

### Methodology Section:
- Dataset preprocessing (`datasets/processed/`)
- Training configuration (stored in `models/v*/`)
- Model versioning and iteration (v1 â†’ v2)

---

## ğŸ” Quick Reference

| Task | Command | Output |
|------|---------|--------|
| Merge datasets | `python scripts/training/run_merge_busay.py` | `datasets/processed/` |
| Train model | `python scripts/training/train_vehicle_detector.py --data ... --project ../../models/v1` | `models/v1/*/weights/best.pt` |
| Test model | `python scripts/training/train_vehicle_detector.py --test --model-path ...` | Console output |
| Speed detection | `python scripts/download/auto_download_coco.py` | Annotated video |
| Calibrate camera | `python scripts/download/angled_camera_calibration.py` | Calibration params |

---

## ğŸ“ Help

- **General:** README.md
- **Training:** scripts/training/README.md
- **Datasets:** datasets/README.md
- **Models:** models/README.md
- **Dataset strategy:** scripts/training/DATASET_STRATEGY_GUIDE.md
- **Dual models:** scripts/training/DUAL_MODEL_TRAINING_GUIDE.md
